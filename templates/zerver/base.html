<!DOCTYPE html>
<html lang='{{LANGUAGE_CODE}}'>

    {# Base template for the whole site. #}

    <head>
        <meta charset="UTF-8" />
        {% block title %}
            {% if user_profile and user_profile.realm.name %}
                <title>{{user_profile.realm.name}} - Zulip</title>
            {% else %}
                {% if OPEN_GRAPH_TITLE %}
                <title>{{ OPEN_GRAPH_TITLE }}</title>
                {% else %}
                <title>Zulip</title>
                {% endif %}
            {% endif %}
        {% endblock %}
        <!--
        The order of the alternate_icon and the icon here is important.

        The spec (https://html.spec.whatwg.org/multipage/links.html#rel-icon)
        mentions "If there are multiple equally appropriate icons,
        user agents must use the last one declared in tree order at
        the time that the user agent collected the list of icons."

        If the order was reversed and the user had realm_icon_as_favicon
        set to true, we would have a bug whereby after once getting to 0
        unreads (ie this would not be seen on first page load) the png
        image would be favoured in lace of the svg image ie the count
        would not be shown.

        It's unclear why the same bug isn't seen with the default
        zulip svg.
        -->
        {% if user_profile and user_profile.realm_icon_as_favicon %}
        <link id="alternate_icon" rel="alternate icon" href="{{ page_params.realm_icon_url }}" sizes="any"/>
        <link id="favicon" rel="icon" href="{{ page_params.realm_icon_url }}" sizes="any"/>
        {% else %}
        <link id="alternate_icon" rel="alternate icon" href="/static/images/favicon.png?v=4" />
        <link id="favicon" rel="icon" href="/static/images/favicon.svg?v=4" />
        {% endif %}
        {% block meta_viewport %}
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        {% endblock %}
        {% if not user_profile %}
        {% include 'zerver/meta_tags.html' %}
        {% endif %}

        {% block webpack %}
            {% for filename in webpack_entry(entrypoint) -%}
                {% if filename.endswith(".css") -%}
                    <link href="{{ filename }}" rel="stylesheet" {% if csp_nonce %}nonce="{{ csp_nonce }}"{% endif %} />
                {% elif filename.endswith(".js") -%}
                    <script src="{{ filename }}" defer {% if csp_nonce %}nonce="{{ csp_nonce }}"{% endif %}></script>
                {% endif -%}
            {% endfor %}
        {% endblock %}

        {% block customhead %}
        {% endblock %}
    </head>

    <body {% if color_scheme == 1 %} class="color-scheme-automatic" {% elif color_scheme == 2 %} class="dark-theme" {% endif %}>
        {% block content %}
        {% endblock %}

        {% set all_page_params = default_page_params.copy() %}
        {% set _ = all_page_params.update(page_params|default({})) %}
        <div hidden id="page-params" data-params='{{ all_page_params|tojson }}'></div>
    </body>

</html>

{% set entrypoint = entrypoint|default("common") %}
